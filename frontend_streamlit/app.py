"""
AI DECLARANT - Streamlit Frontend
–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–¥–æ–≤ –¢–ù –í–≠–î
"""

import streamlit as st
import os
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ backend –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —É—Ç–∏–ª–∏—Ç
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'backend'))

from pages import (
    home,
    upload,
    tasks,
    results,
    hs_codes
)
from utils.auth import require_auth, show_user_info, is_authenticated

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="AI DECLARANT",
    page_icon="üìã",
    layout="wide",
    initial_sidebar_state="expanded"
)

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    st.title("ü§ñ AI DECLARANT")
    st.markdown("**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–æ–≤ –¢–ù –í–≠–î –¥–ª—è —Ç–∞–º–æ–∂–µ–Ω–Ω—ã—Ö –±—Ä–æ–∫–µ—Ä–æ–≤**")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    if not is_authenticated():
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        home.show()
        return
    
    # –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    with st.sidebar:
        st.header("üìã –ù–∞–≤–∏–≥–∞—Ü–∏—è")
        
        # –ú–µ–Ω—é —Å—Ç—Ä–∞–Ω–∏—Ü
        page = st.selectbox(
            "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É:",
            [
                "üè† –ì–ª–∞–≤–Ω–∞—è",
                "üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤", 
                "üìä –ú–æ–∏ –∑–∞–¥–∞—á–∏",
                "üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã",
                "üîç –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ HS –∫–æ–¥–æ–≤"
            ]
        )
        
        st.markdown("---")
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
        st.subheader("‚ÑπÔ∏è –û —Å–∏—Å—Ç–µ–º–µ")
        st.markdown("""
        **–í–µ—Ä—Å–∏—è:** 1.0.0  
        **–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ  
        **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** Excel, CSV —Ñ–∞–π–ª—ã  
        **–ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä:** 10 MB  
        **–ú–∞–∫—Å. –ø–æ–∑–∏—Ü–∏–π:** 1000
        """)
        
        # –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
        st.markdown("---")
        st.subheader("‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è")
        
        if st.button("üÜï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞", use_container_width=True):
            st.session_state.page = "üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤"
            st.rerun()
            
        if st.button("üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å", use_container_width=True):
            st.session_state.page = "üìä –ú–æ–∏ –∑–∞–¥–∞—á–∏"
            st.rerun()
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    show_user_info()
    
    # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    if page == "üè† –ì–ª–∞–≤–Ω–∞—è":
        home.show()
    elif page == "üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤":
        upload.show()
    elif page == "üìä –ú–æ–∏ –∑–∞–¥–∞—á–∏":
        tasks.show()
    elif page == "üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã":
        results.show()
    elif page == "üîç –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ HS –∫–æ–¥–æ–≤":
        hs_codes.show()

if __name__ == "__main__":
    main()
